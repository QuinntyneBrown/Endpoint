<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2024-01-10T00:00:00.000Z" agent="Mozilla/5.0" version="22.1.0" type="device">
  <diagram name="Aspire Service Topology" id="aspire-topology">
    <mxGraphModel dx="1400" dy="1000" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Design 3: Aspire Service Topology" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=22;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="450" y="20" width="500" height="40" as="geometry" />
        </mxCell>

        <!-- Aspire Dashboard -->
        <mxCell id="dashboard" value="Aspire Dashboard&#xa;(Observability)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1a73e8;strokeColor=#0d47a1;fontColor=#ffffff;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="540" y="80" width="180" height="60" as="geometry" />
        </mxCell>

        <!-- AppHost Container -->
        <mxCell id="apphost" value="" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=40;horizontal=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=2;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="100" y="180" width="1100" height="700" as="geometry" />
        </mxCell>

        <mxCell id="apphostTitle" value="MySolution.AppHost (Orchestrator)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;" vertex="1" parent="apphost">
          <mxGeometry x="400" y="5" width="300" height="30" as="geometry" />
        </mxCell>

        <!-- Service Defaults -->
        <mxCell id="serviceDefaults" value="ServiceDefaults&#xa;&#xa;• OpenTelemetry&#xa;• Health Checks&#xa;• Service Discovery&#xa;• HTTP Resilience" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#43a047;fontSize=11;align=left;spacingLeft=10;" vertex="1" parent="apphost">
          <mxGeometry x="420" y="60" width="160" height="100" as="geometry" />
        </mxCell>

        <!-- API Gateway -->
        <mxCell id="gateway" value="API Gateway&#xa;(YARP)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#ef6c00;fontSize=12;fontStyle=1;" vertex="1" parent="apphost">
          <mxGeometry x="450" y="200" width="120" height="50" as="geometry" />
        </mxCell>

        <!-- Microservices Row -->
        <mxCell id="orderService" value="" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=30;horizontal=1;fillColor=#e3f2fd;strokeColor=#1976d2;rounded=1;" vertex="1" parent="apphost">
          <mxGeometry x="80" y="300" width="200" height="180" as="geometry" />
        </mxCell>
        <mxCell id="orderTitle" value="Order Service" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;" vertex="1" parent="orderService">
          <mxGeometry x="50" y="5" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="orderDomain" value="Domain" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;fontSize=10;" vertex="1" parent="orderService">
          <mxGeometry x="10" y="40" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="orderApp" value="Application" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;fontSize=10;" vertex="1" parent="orderService">
          <mxGeometry x="105" y="40" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="orderInfra" value="Infrastructure" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;fontSize=10;" vertex="1" parent="orderService">
          <mxGeometry x="10" y="75" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="orderApi" value="API" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;fontSize=10;" vertex="1" parent="orderService">
          <mxGeometry x="105" y="75" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="orderPort" value=":5001" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="orderService">
          <mxGeometry x="75" y="110" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="orderEndpoint" value="http://orderservice" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;" vertex="1" parent="orderService">
          <mxGeometry x="25" y="130" width="150" height="20" as="geometry" />
        </mxCell>

        <mxCell id="inventoryService" value="" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=30;horizontal=1;fillColor=#e8f5e9;strokeColor=#43a047;rounded=1;" vertex="1" parent="apphost">
          <mxGeometry x="330" y="300" width="200" height="180" as="geometry" />
        </mxCell>
        <mxCell id="invTitle" value="Inventory Service" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;" vertex="1" parent="inventoryService">
          <mxGeometry x="40" y="5" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="invDomain" value="Domain" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#43a047;fontSize=10;" vertex="1" parent="inventoryService">
          <mxGeometry x="10" y="40" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="invApp" value="Application" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#43a047;fontSize=10;" vertex="1" parent="inventoryService">
          <mxGeometry x="105" y="40" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="invInfra" value="Infrastructure" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#43a047;fontSize=10;" vertex="1" parent="inventoryService">
          <mxGeometry x="10" y="75" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="invApi" value="API" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#43a047;fontSize=10;" vertex="1" parent="inventoryService">
          <mxGeometry x="105" y="75" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="invPort" value=":5002" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="inventoryService">
          <mxGeometry x="75" y="110" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="invEndpoint" value="http://inventoryservice" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;" vertex="1" parent="inventoryService">
          <mxGeometry x="20" y="130" width="160" height="20" as="geometry" />
        </mxCell>

        <mxCell id="customerService" value="" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=30;horizontal=1;fillColor=#fff3e0;strokeColor=#ef6c00;rounded=1;" vertex="1" parent="apphost">
          <mxGeometry x="580" y="300" width="200" height="180" as="geometry" />
        </mxCell>
        <mxCell id="custTitle" value="Customer Service" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;" vertex="1" parent="customerService">
          <mxGeometry x="40" y="5" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="custDomain" value="Domain" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ef6c00;fontSize=10;" vertex="1" parent="customerService">
          <mxGeometry x="10" y="40" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="custApp" value="Application" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ef6c00;fontSize=10;" vertex="1" parent="customerService">
          <mxGeometry x="105" y="40" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="custInfra" value="Infrastructure" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ef6c00;fontSize=10;" vertex="1" parent="customerService">
          <mxGeometry x="10" y="75" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="custApi" value="API" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ef6c00;fontSize=10;" vertex="1" parent="customerService">
          <mxGeometry x="105" y="75" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="custPort" value=":5003" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="customerService">
          <mxGeometry x="75" y="110" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="custEndpoint" value="http://customerservice" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;" vertex="1" parent="customerService">
          <mxGeometry x="20" y="130" width="160" height="20" as="geometry" />
        </mxCell>

        <mxCell id="notificationWorker" value="" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=30;horizontal=1;fillColor=#fce4ec;strokeColor=#c2185b;rounded=1;" vertex="1" parent="apphost">
          <mxGeometry x="830" y="300" width="200" height="180" as="geometry" />
        </mxCell>
        <mxCell id="notifTitle" value="Notification Worker" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;" vertex="1" parent="notificationWorker">
          <mxGeometry x="30" y="5" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="notifWorkerIcon" value="Background&#xa;Worker" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8bbd0;strokeColor=#c2185b;fontSize=11;" vertex="1" parent="notificationWorker">
          <mxGeometry x="50" y="50" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="notifNote" value="No HTTP endpoint&#xa;Consumes messages" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;" vertex="1" parent="notificationWorker">
          <mxGeometry x="25" y="110" width="150" height="30" as="geometry" />
        </mxCell>

        <!-- Resources Row -->
        <mxCell id="postgres" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#e3f2fd;strokeColor=#1565c0;" vertex="1" parent="apphost">
          <mxGeometry x="130" y="540" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="postgresLabel" value="PostgreSQL" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;" vertex="1" parent="apphost">
          <mxGeometry x="130" y="560" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="postgresDBs" value="ordersdb&#xa;inventorydb&#xa;customersdb" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="apphost">
          <mxGeometry x="130" y="580" width="100" height="40" as="geometry" />
        </mxCell>

        <mxCell id="redis" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#ffebee;strokeColor=#c62828;" vertex="1" parent="apphost">
          <mxGeometry x="330" y="540" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="redisLabel" value="Redis" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;" vertex="1" parent="apphost">
          <mxGeometry x="330" y="560" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="redisUse" value="Distributed Cache&#xa;Session Store" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="apphost">
          <mxGeometry x="330" y="580" width="100" height="30" as="geometry" />
        </mxCell>

        <mxCell id="rabbitmq" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#fff8e1;strokeColor=#ff8f00;" vertex="1" parent="apphost">
          <mxGeometry x="530" y="540" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="rabbitmqLabel" value="RabbitMQ" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;" vertex="1" parent="apphost">
          <mxGeometry x="530" y="560" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rabbitmqUse" value="Message Broker" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="apphost">
          <mxGeometry x="530" y="580" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="azureStorage" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#e8eaf6;strokeColor=#3f51b5;" vertex="1" parent="apphost">
          <mxGeometry x="730" y="540" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="azureStorageLabel" value="Azure Storage" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;" vertex="1" parent="apphost">
          <mxGeometry x="730" y="560" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="azureStorageUse" value="Blob Storage&#xa;File Uploads" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" vertex="1" parent="apphost">
          <mxGeometry x="730" y="580" width="100" height="30" as="geometry" />
        </mxCell>

        <!-- Connection Arrows -->
        <mxCell id="dashToApphost" value="Telemetry" style="endArrow=classic;html=1;strokeWidth=2;dashed=1;fillColor=#1a73e8;strokeColor=#1a73e8;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="630" y="140" as="sourcePoint" />
            <mxPoint x="630" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Gateway to Services -->
        <mxCell id="gwToOrder" value="" style="endArrow=classic;html=1;strokeWidth=1;fillColor=#ef6c00;strokeColor=#ef6c00;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="510" y="430" as="sourcePoint" />
            <mxPoint x="280" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="gwToInv" value="" style="endArrow=classic;html=1;strokeWidth=1;fillColor=#ef6c00;strokeColor=#ef6c00;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="560" y="430" as="sourcePoint" />
            <mxPoint x="530" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="gwToCust" value="" style="endArrow=classic;html=1;strokeWidth=1;fillColor=#ef6c00;strokeColor=#ef6c00;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="610" y="430" as="sourcePoint" />
            <mxPoint x="780" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend" value="Legend" style="swimlane;fontStyle=1;align=center;verticalAlign=top;startSize=26;horizontal=1;fillColor=#f5f5f5;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1220" y="180" width="160" height="200" as="geometry" />
        </mxCell>
        <mxCell id="legSvc" value="Microservice" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1976d2;fontSize=10;" vertex="1" parent="legend">
          <mxGeometry x="10" y="35" width="65" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legWorker" value="Worker" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#c2185b;fontSize=10;" vertex="1" parent="legend">
          <mxGeometry x="85" y="35" width="65" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legGw" value="Gateway" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#ef6c00;fontSize=10;" vertex="1" parent="legend">
          <mxGeometry x="10" y="70" width="65" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legDb" value="Database" style="shape=cylinder3;whiteSpace=wrap;html=1;size=10;fillColor=#e3f2fd;strokeColor=#1565c0;fontSize=10;" vertex="1" parent="legend">
          <mxGeometry x="85" y="65" width="65" height="35" as="geometry" />
        </mxCell>
        <mxCell id="legDefaults" value="ServiceDefaults" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#43a047;fontSize=10;" vertex="1" parent="legend">
          <mxGeometry x="10" y="110" width="140" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legTelem" value="--- Telemetry" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#1a73e8;" vertex="1" parent="legend">
          <mxGeometry x="10" y="145" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legRoute" value="→ Routing" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#ef6c00;" vertex="1" parent="legend">
          <mxGeometry x="10" y="165" width="80" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
